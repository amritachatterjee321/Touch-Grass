/* Mobile-First Optimizations for TouchGrass */

/* Viewport and Touch Optimizations */
@media screen and (max-width: 768px) {
  html {
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  body {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Safe Area Insets for modern mobile devices */
  .safe-area-inset-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-inset-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-inset-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-inset-right {
    padding-right: env(safe-area-inset-right);
  }

  .safe-area-insets {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  /* Curved screen corner protection */
  .curved-screen-safe {
    margin-left: max(8px, env(safe-area-inset-left));
    margin-right: max(8px, env(safe-area-inset-right));
  }

  /* Header content protection from curved screens */
  .header-safe-content {
    padding-left: max(16px, calc(16px + env(safe-area-inset-left)));
    padding-right: max(16px, calc(16px + env(safe-area-inset-right)));
  }

  /* Footer content protection from curved screens */
  .footer-safe-content {
    padding-left: max(8px, calc(8px + env(safe-area-inset-left)));
    padding-right: max(8px, calc(8px + env(safe-area-inset-right)));
  }

  /* Floating element positioning adjustment */
  .floating-safe-position {
    right: max(16px, calc(16px + env(safe-area-inset-right)));
    left: max(16px, calc(16px + env(safe-area-inset-left)));
  }

  /* Touch-friendly sizing */
  .touch-manipulation {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  /* Minimum touch target size enforcement */
  button, a, input, select, textarea {
    min-height: 44px;
    min-width: 44px;
  }

  /* Improved scrolling for mobile */
  .mobile-scroll {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .mobile-scroll::-webkit-scrollbar {
    display: none;
  }

  /* Mobile-specific animations (reduced motion) */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Mobile keyboard handling */
  .mobile-form-input {
    font-size: 16px; /* Prevents zoom on iOS */
  }

  /* High DPI display optimization */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .pixelated {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: -webkit-crisp-edges;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
      image-rendering: pixelated;
    }
  }
}

/* Portrait orientation optimizations */
@media screen and (orientation: portrait) and (max-width: 768px) {
  .portrait-optimized {
    padding-left: 16px;
    padding-right: 16px;
  }

  .portrait-card-spacing {
    margin-bottom: 16px;
  }
}

/* Landscape orientation optimizations */
@media screen and (orientation: landscape) and (max-height: 500px) {
  .landscape-compact {
    padding-top: 8px;
    padding-bottom: 8px;
  }

  .landscape-header {
    padding-top: 12px;
    padding-bottom: 12px;
  }
}

/* iPhone specific optimizations */
@supports (-webkit-touch-callout: none) {
  .ios-optimized {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }
}

/* Android specific optimizations */
@media screen and (-webkit-device-pixel-ratio: 1.5) {
  .android-optimized {
    -webkit-font-smoothing: subpixel-antialiased;
  }
}

/* Accessibility improvements for mobile */
@media (prefers-contrast: high) {
  .high-contrast-mobile {
    border-width: 2px;
    outline-width: 3px;
  }
}

/* Mobile login modal specific fixes */
.mobile-login-modal {
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  width: calc(100vw - 32px) !important;
  max-width: calc(100vw - 32px) !important;
  max-height: calc(100vh - 32px) !important;
  margin: 0 !important;
  z-index: 1000 !important;
}

/* Mobile modal optimizations */
.mobile-modal {
  margin: 16px !important;
  max-width: calc(100vw - 32px) !important;
  width: calc(100vw - 32px) !important;
  max-height: calc(100vh - 32px) !important;
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
}

/* Ensure modal backdrop covers full screen on mobile */
@media screen and (max-width: 768px) {
  [data-radix-dialog-overlay] {
    position: fixed !important;
    inset: 0 !important;
    background-color: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(4px) !important;
    z-index: 50 !important;
  }
  
  [data-radix-dialog-content] {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: 0 !important;
    max-width: calc(100vw - 32px) !important;
    width: calc(100vw - 32px) !important;
    max-height: calc(100vh - 32px) !important;
    z-index: 51 !important;
  }

  /* Specific override for mobile login modal */
  .mobile-login-modal {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: calc(100vw - 32px) !important;
    max-width: calc(100vw - 32px) !important;
    max-height: calc(100vh - 32px) !important;
    margin: 0 !important;
    z-index: 1000 !important;
  }

  /* Prevent body scroll when modal is open */
  body:has([data-radix-dialog-overlay]) {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
  }
}

/* Extra small screens */
@media screen and (max-width: 480px) {
  [data-radix-dialog-content] {
    max-width: calc(100vw - 16px) !important;
    width: calc(100vw - 16px) !important;
    max-height: calc(100vh - 16px) !important;
    margin: 8px !important;
  }

  .mobile-login-modal {
    width: calc(100vw - 16px) !important;
    max-width: calc(100vw - 16px) !important;
    max-height: calc(100vh - 16px) !important;
  }
}